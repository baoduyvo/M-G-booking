<!DOCTYPE html>
<html lang="en" th:replace="~{/Owner/layout/layout :: mainContent('add Room',~{this::#main})}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<div id="main" class="relative h-full max-h-screen transition-all duration-200 ease-in-out xl:ml-68">
    <nav class="absolute z-20 flex flex-wrap items-center justify-between w-full px-6 py-2 -mt-56 text-white transition-all ease-in shadow-none duration-250 lg:flex-nowrap lg:justify-start" navbar-profile navbar-scroll="true">
        <div class="flex items-center justify-between w-full px-6 py-1 mx-auto flex-wrap-inherit">
            <nav>
                <!-- breadcrumb -->
                <ol class="flex flex-wrap pt-1 pl-2 pr-4 mr-12 bg-transparent rounded-lg sm:mr-16">
                    <li class="leading-normal text-sm">
                        <a class="opacity-50" href="javascript:;">Pages</a>
                    </li>
                    <li class="text-sm pl-2 capitalize leading-normal before:float-left before:pr-2 before:content-['/']" aria-current="page">Profile</li>
                </ol>
                <h6 class="mb-2 ml-2 font-bold text-white capitalize dark:text-white">Profile</h6>
            </nav>

            <div class="flex items-center mt-2 grow sm:mt-0 sm:mr-6 md:mr-0 lg:flex lg:basis-auto">
                <div class="flex items-center md:ml-auto md:pr-4">
                    <div class="relative flex flex-wrap items-stretch w-full transition-all rounded-lg ease">
                <span class="text-sm ease leading-5.6 absolute z-50 -ml-px flex h-full items-center whitespace-nowrap rounded-lg rounded-tr-none rounded-br-none border border-r-0 border-transparent bg-transparent py-2 px-2.5 text-center font-normal text-slate-500 transition-all">
                  <i class="fas fa-search" aria-hidden="true"></i>
                </span>
                        <input type="text" class="pl-9 text-sm dark:bg-slate-850 dark:text-white focus:shadow-primary-outline ease w-1/100 leading-5.6 relative -ml-px block min-w-0 flex-auto rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding py-2 pr-3 text-gray-700 transition-all placeholder:text-gray-500 focus:border-blue-500 focus:outline-none focus:transition-shadow" placeholder="Type here..." />
                    </div>
                </div>
                <ul class="flex flex-row justify-end pl-0 mb-0 list-none md-max:w-full">
                    <!-- online builder btn  -->
                    <!-- <li class="flex items-center">
                      <a class="inline-block px-8 py-2 mb-0 mr-4 font-bold text-center text-white uppercase align-middle transition-all ease-in border border-solid rounded-lg shadow-none cursor-pointer leading-pro border-white/75 bg-white/10 text-xs hover:-translate-y-px active:shadow-xs tracking-tight-rem hover:border-white hover:bg-transparent hover:text-white hover:opacity-75 hover:shadow-none active:bg-white active:text-black active:hover:bg-transparent active:hover:text-white" target="_blank" href="https://www.creative-tim.com/builder/soft-ui?ref=navbar-dashboard&amp;_ga=2.76518741.1192788655.1647724933-1242940210.1644448053">Online Builder</a>
                    </li> -->
                    <li class="flex items-center">
                        <a th:href="@{/account/logout}" class="block px-0 py-2 font-semibold text-white transition-all ease-in-out text-sm">
                            <i class="fa fa-user sm:mr-1" aria-hidden="true"></i>
                            <span class="hidden sm:inline">Log out</span>
                        </a>
                    </li>
                    <li class="flex items-center pl-4 xl:hidden">
                        <a href="javascript:;" class="block p-0 text-white transition-all ease-in-out text-sm" sidenav-trigger>
                            <div class="w-4.5 overflow-hidden">
                                <i class="ease mb-0.75 relative block h-0.5 rounded-sm bg-white transition-all"></i>
                                <i class="ease mb-0.75 relative block h-0.5 rounded-sm bg-white transition-all"></i>
                                <i class="ease relative block h-0.5 rounded-sm bg-white transition-all"></i>
                            </div>
                        </a>
                    </li>
                    <li class="flex items-center px-4">
                        <a href="javascript:;" class="p-0 text-white transition-all ease-in-out text-sm">
                            <i fixed-plugin-button-nav class="cursor-pointer fa fa-cog" aria-hidden="true"></i>
                            <!-- fixed-plugin-button-nav  -->
                        </a>
                    </li>

                    <!-- notifications -->

                    <li class="relative flex items-center pr-2">
                        <p class="hidden dark:text-white dark:opacity-60 transform-dropdown-show"></p>
                        <a dropdown-trigger href="javascript:;" class="block p-0 text-white transition-all text-sm ease-nav-brand" aria-expanded="false">
                            <i class="cursor-pointer fa fa-bell" aria-hidden="true"></i>
                        </a>

                        <ul dropdown-menu class="text-sm transform-dropdown before:font-awesome before:leading-default before:duration-350 before:ease lg:shadow-3xl duration-250 min-w-44 before:sm:right-8 before:text-5.5 pointer-events-none absolute right-0 top-0 z-50 origin-top list-none rounded-lg border-0 border-solid border-transparent bg-white bg-clip-padding px-2 py-4 text-left text-slate-500 opacity-0 transition-all before:absolute before:right-2 before:left-auto before:top-0 before:z-50 before:inline-block before:font-normal before:text-white before:antialiased before:transition-all before:content-['\f0d8'] sm:-mr-6 lg:absolute lg:right-0 lg:left-auto lg:mt-2 lg:block lg:cursor-pointer">
                            <!-- add show class on dropdown open js -->
                            <li class="relative mb-2">
                                <a class="ease py-1.2 clear-both block w-full whitespace-nowrap rounded-lg bg-transparent px-4 duration-300 lg:transition-colors" href="javascript:;">
                                    <div class="flex py-1">
                                        <div class="my-auto">
                                            <img src="../assets/img/team-2.jpg" class="inline-flex items-center justify-center mr-4 text-white text-sm h-9 w-9 max-w-none rounded-xl" />
                                        </div>
                                        <div class="flex flex-col justify-center">
                                            <h6 class="mb-1 font-normal leading-normal dark:text-white text-sm"><span class="font-semibold">New message</span> from Laur</h6>
                                            <p class="mb-0 leading-tight dark:text-white dark:opacity-60 text-xs text-slate-400">
                                                <i class="mr-1 fa fa-clock" aria-hidden="true"></i>
                        B                        13 minutes ago
                                            </p>
                                        </div>
                                    </div>
                                </a>
                            </li>

                            <li class="relative mb-2">
                                <a class="ease py-1.2 clear-both block w-full whitespace-nowrap rounded-lg px-4 duration-300 lg:transition-colors" href="javascript:;">
                                    <div class="flex py-1">
                                        <div class="my-auto">
                                            <img src="../assets/img/small-logos/logo-spotify.svg" class="inline-flex items-center justify-center mr-4 text-white text-sm bg-gradient-to-tl from-zinc-800 to-zinc-700 dark:bg-gradient-to-tl dark:from-slate-750 dark:to-gray-850 h-9 w-9 max-w-none rounded-xl" />
                                        </div>
                                        <div class="flex flex-col justify-center">
                                            <h6 class="mb-1 font-normal leading-normal dark:text-white text-sm"><span class="font-semibold">New album</span> by Travis Scott</h6>
                                            <p class="mb-0 leading-tight dark:text-white dark:opacity-60 text-xs text-slate-400">
                                                <i class="mr-1 fa fa-clock" aria-hidden="true"></i>
                                                1 day
                                            </p>
                                        </div>
                                    </div>
                                </a>
                            </li>

                            <li class="relative">
                                <a class="ease py-1.2 clear-both block w-full whitespace-nowrap rounded-lg px-4 duration-300 lg:transition-colors" href="javascript:;">
                                    <div class="flex py-1">
                                        <div class="inline-flex items-center justify-center my-auto mr-4 text-white transition-all duration-200 ease-in-out text-sm bg-gradient-to-tl from-slate-600 to-slate-300 h-9 w-9 rounded-xl">
                                            <svg width="12px" height="12px" viewBox="0 0 43 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                                <title>credit-card</title>
                                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                    <g transform="translate(-2169.000000, -745.000000)" fill="#FFFFFF" fill-rule="nonzero">
                                                        <g transform="translate(1716.000000, 291.000000)">
                                                            <g transform="translate(453.000000, 454.000000)">
                                                                <path class="color-background" d="M43,10.7482083 L43,3.58333333 C43,1.60354167 41.3964583,0 39.4166667,0 L3.58333333,0 C1.60354167,0 0,1.60354167 0,3.58333333 L0,10.7482083 L43,10.7482083 Z" opacity="0.593633743"></path>
                                                                <path class="color-background" d="M0,16.125 L0,32.25 C0,34.2297917 1.60354167,35.8333333 3.58333333,35.8333333 L39.4166667,35.8333333 C41.3964583,35.8333333 43,34.2297917 43,32.25 L43,16.125 L0,16.125 Z M19.7083333,26.875 L7.16666667,26.875 L7.16666667,23.2916667 L19.7083333,23.2916667 L19.7083333,26.875 Z M35.8333333,26.875 L28.6666667,26.875 L28.6666667,23.2916667 L35.8333333,23.2916667 L35.8333333,26.875 Z"></path>
                                                            </g>
                                                        </g>
                                                    </g>
                                                </g>
                                            </svg>
                                        </div>
                                        <div class="flex flex-col justify-center">
                                            <h6 class="mb-1 font-normal leading-normal dark:text-white text-sm">Payment successfully completed</h6>
                                            <p class="mb-0 leading-tight dark:text-white dark:opacity-60 text-xs text-slate-400">
                                                <i class="mr-1 fa fa-clock" aria-hidden="true"></i>
                                                2 days
                                            </p>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="relative w-full mx-auto mt-60 ">


    </div>
    <input type="hidden" th:field="${type.hotelId}" id="hotelId">
    <form th:action="@{/Owner/Room/add}" method="post" enctype="multipart/form-data">
        <div class="w-full p-6 mx-auto">
            <div class="flex flex-wrap -mx-3">
                <!-- Service Name Section -->
                <div class="w-full max-w-full px-3 shrink-0 md:w-8/12 md:flex-0">
                    <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border">
                        <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
                            <div class="flex items-center justify-content-between">
                                <p class="mb-0 dark:text-white/80">Room</p>
                                <button type="button"  class="btn btn-primary  text-wrap  " id="openModalBtn" style="background-color: #0b5ed7">
                                    <i class="fa-solid fa-plus"></i>
                                    Add Type</button>
                            </div>
                        </div>
                        <div class="flex-auto p-6">
                            <div class="flex flex-wrap -mx-3">
                                <div class="w-full max-w-full px-3 shrink-0 md:w-12/12 md:flex-0">
                                    <div class="mb-4">
                                        <label for="numRooms" class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Number of Rooms</label>
                                        <input type="number" id="numRooms" name="numRooms" min="1" required class="w-full px-3 py-2 text-sm leading-5.6 ease block appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding font-normal text-gray-700 focus:border-blue-500 focus:outline-none" placeholder="Enter the number of rooms" />
                                    </div>

                                    <!-- Container to hold dynamically generated room fields -->
                                    <div id="rooms-container"></div>

                                </div>
                            </div>
                            <hr class="h-px mx-0 my-4 bg-transparent border-0 opacity-25 bg-gradient-to-r from-transparent via-black/40 to-transparent dark:bg-gradient-to-r dark:from-transparent dark:via-white dark:to-transparent " />
                        </div>
                    </div>
                </div>

                <!-- Room Input Section -->
                <div class="w-full max-w-full px-3 mt-6 shrink-0 md:w-4/12 md:flex-0 md:mt-0">
                    <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border">
                        <div class="border-black/12.5 rounded-t-2xl p-6 text-center pt-0 pb-6 lg:pt-2 lg:pb-4" style="border-bottom: 1px solid #e6e7e9;padding: 16px">
                            <div class="flex justify-center">
                                Rooms Information
                            </div>
                        </div>
                        <div class="flex-auto p-6 pt-0 mt-5">
                            <!-- Number of Rooms -->

                            <!-- Submit Button -->
                            <div class="w-100 d-flex align-items-center h-100 gap-2">
                                <button type="submit" class="btn btn-primary flex-column-gap-1 text-wrap p-2 flex-grow-1" style="background-color: #0b5ed7">Save</button>
                                <a th:href="@{'/Owner/Room/'+${id}}" class="btn p-2 text-wrap w-50" style="border: 1px solid #e6e7e9">Back</a>
                                <input type="hidden" name="IdHotel" th:value="${id}">
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <footer class="pt-4">
                <div class="w-full px-6 mx-auto">
                    <div class="flex flex-wrap items-center -mx-3 lg:justify-between">
                        <div class="w-full max-w-full px-3 mt-0 mb-6 shrink-0 lg:mb-0 lg:w-1/2 lg:flex-none">
                            <div class="leading-normal text-center text-sm text-slate-500 lg:text-left">
                                ©
                                <script>
                                    document.write(new Date().getFullYear() + ",");
                                </script>
                                made with <i class="fa fa-heart"></i> by
                                <a href="https://www.creative-tim.com" class="font-semibold dark:text-white text-slate-700" target="_blank">Creative Tim</a>
                                for a better web.
                            </div>
                        </div>
                        <div class="w-full max-w-full px-3 mt-0 shrink-0 lg:w-1/2 lg:flex-none">
                            <ul class="flex flex-wrap justify-center pl-0 mb-0 list-none lg:justify-end">
                                <li class="nav-item">
                                    <a href="https://www.creative-tim.com" class="block px-4 pt-0 pb-1 font-normal transition-colors ease-in-out text-sm text-slate-500" target="_blank">Creative Tim</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </form>

    <div class="modal" id="customModal">
        <form th:action="@{/Owner/Room/addType}" method="post" id="typeForm">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Add Type</h5>
                <button type="button" class="close-btn" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body">

                    <div class="mb-3">
                        <label for="typeName" class="form-label">Type Name</label>
                        <input type="text" id="typeName" th:field="${type.name}" placeholder="Enter type name" class="form-control">
                    </div>
                <div class="mb-3">
                        <label for="typeName" class="form-label">Price</label>
                        <input type="text" id="Price" th:field="${type.price}" placeholder="Enter type name" class="form-control">
                    </div>


            </div>
            <div class="modal-footer">
                <input type="hidden" th:field="${type.hotelId}"/>

                <button class="btn-primary" id="saveModalBtn">Save Type</button>
            </div>
        </div>
        </form>
    </div>
    <script>
        // Function to generate room fields dynamically
        document.getElementById('numRooms').addEventListener('input', function() {
            const numRooms = parseInt(this.value);
            const container = document.getElementById('rooms-container');
            container.innerHTML = '';  // Clear previous fields

            if (numRooms > 0 && numRooms<20) {
                for (let i = 1; i <= numRooms; i++) {
                    const roomDiv = document.createElement('div');
                    roomDiv.classList.add('room-group');
                    roomDiv.innerHTML = `
                    <h4>Room ${i}</h4>
                    <label for="roomType${i}" class="font-bold text-xs text-slate-700 dark:text-white/80">Room Type</label>
                    <select  id="roomType${i}" name="roomTypes[]" class="w-full px-3 py-2 text-sm leading-5.6 ease block appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding font-normal text-gray-700 focus:border-blue-500 focus:outline-none" placeholder="Enter Room Type">
                    <option value="Single Room">Single Room</option>
                    <option value="Double Room">Double Room</option>
                    <option value="Twin Room">Twin Room</option>
                    <option value="Triple Room">Triple Room</option>
                    <option value="Family Room">Family Room</option>
</select>


                      <label for="roomoccupancy${i}" class="font-bold text-xs text-slate-700 dark:text-white/80">occupancy</label>
                    <input type="number" id="roomoccupancy${i}" name="roomCapacities[]" class="w-full px-3 py-2 text-sm leading-5.6 ease block appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding font-normal text-gray-700 focus:border-blue-500 focus:outline-none" placeholder="Enter Room Price">
                       <label for="roomImages${i}" class="font-bold text-xs text-slate-700 dark:text-white/80">Room Images</label>
                    <input type="file" id="roomImages${i}" name="roomImages" class="w-full px-3 py-2 text-sm leading-5.6 ease block appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding font-normal text-gray-700 focus:border-blue-500 focus:outline-none" accept="image/*" >
                       <div id="previewRoomImages${i}" class="flex flex-wrap gap-2 mt-2"></div>
                `;
                    container.appendChild(roomDiv);
                    fetchRoomTypes(i);
                    document.getElementById(`roomImages${i}`).addEventListener('change', function (event) {
                        const previewContainer = document.getElementById(`previewRoomImages${i}`);
                        previewContainer.innerHTML = ''; // Clear previous previews
                        const files = event.target.files;
                        if (files && files.length > 0) { // Ensure at least one file is selected
                            const file = files[0]; // Only take the first file
                            const reader = new FileReader();
                            reader.onload = function (e) {
                                const img = document.createElement('img');
                                img.src = e.target.result;
                                img.alt = file.name;
                                img.classList.add('h-auto', 'rounded-lg', 'border', 'border-gray-300', 'mr-2');
                                img.style.setProperty("height", "30vh", "important");
                                img.style.width = '22vh';
                                img.style.objectFit = 'fill';
                                previewContainer.style.display = 'flex';
                                previewContainer.style.flexWrap = 'nowrap';
                                previewContainer.appendChild(img);
                            };
                            reader.readAsDataURL(file);
                        }
                    });

                }
            }
        });
        const modal=document.getElementById('customModal');
        const openModalBtn=document.getElementById('openModalBtn');
        const closeModalBtn=document.getElementById('closeModalBtn');
        const cancelModalBtn=document.getElementById('cancelModalBtn');
        closeModalBtn.addEventListener('click',()=>{
            modal.style.display='none';
        })
        openModalBtn.addEventListener('click', () => {
            modal.style.display = 'flex';
        });
        function fetchRoomTypes(roomIndex){
            const Hotelid=document.getElementById('hotelId').value;
            fetch(`http://localhost:8686/api/type/FindTypeByHotel/${Hotelid}`)
                .then(response => response.json())
                .then(data=>{
                    const roomTypeSelect = document.getElementById(`roomType${roomIndex}`);
                    roomTypeSelect.innerHTML = '';
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.text = 'Select Room Type';
                    roomTypeSelect.appendChild(defaultOption);
                    data.forEach(type => {
                        const option = document.createElement('option');
                        option.value = type.id; // Assuming 'name' is the property returned by the API
                        option.text = type.name;
                        roomTypeSelect.appendChild(option);
                    });
                }).catch(error => {
                console.error('Error fetching room types:', error);
            });

        }
    </script>


</div>
</body>

</html>